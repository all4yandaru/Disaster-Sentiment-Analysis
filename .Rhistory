knitr::opts_chunk$set(echo = TRUE)
bencana_tidy <- bencana %>%
filter(!is.na(location) & !is.na(text)) %>%
group_by(location) %>%
unnest_tokens(word, text) %>%
ungroup() %>%
anti_join(stop_words)
library(shiny)
library(here)
library(vroom)
library(dplyr)
library(ggplot2)
library(plotly)
library(tidyverse)
library(tidytext)
bencana <- vroom(here("data-raw", "tweets.csv"))
glimpse(bencana)
bencana_tidy <- bencana %>%
filter(!is.na(location), !is.na(text)) %>%
group_by(location) %>%
unnest_tokens(word, text) %>%
ungroup() %>%
anti_join(stop_words)
glimpse(bencana_tidy)
bencana_tidy %>% count(location, word, sort = TRUE)
bencana_tidy <- bencana %>%
filter(!is.na(location) | !is.na(text)) %>%
group_by(location) %>%
unnest_tokens(word, text) %>%
ungroup() %>%
anti_join(stop_words)
glimpse(bencana_tidy)
bencana_tidy %>% count(location, word, sort = TRUE)
bencana_tidy <- bencana %>%
filter(!is.na(location), !is.na(text)) %>%
group_by(location) %>%
unnest_tokens(word, text) %>%
ungroup() %>%
anti_join(stop_words)
glimpse(bencana_tidy)
bencana_tidy %>% count(location, word, sort = TRUE)
knitr::opts_chunk$set(echo = TRUE)
#install.packages('topicmodels')
# mengubah ke bentuk dtm biar bisa dipake di LDA
bencana_dtm <- bencana_tidy %>%
count(location, word) %>%
cast_dtm(location, word, n)
library(shiny)
library(here)
library(vroom)
library(dplyr)
library(ggplot2)
library(plotly)
library(topicmodels)
library(tidyverse)
library(tidytext)
bencana <- vroom(here("data-raw", "tweets.csv"))
glimpse(bencana)
bencana_tidy <- bencana %>%
filter(!is.na(location), !is.na(text)) %>%
group_by(location) %>%
unnest_tokens(word, text) %>%
ungroup() %>%
anti_join(stop_words)
# menghapus link yang ada
bencana_tidy <- bencana_tidy %>% filter(word != "t.co", word != "https")
glimpse(bencana_tidy)
bencana_tidy %>% count(location, word, sort = TRUE)
bencana_tfidf <- bencana_tidy %>%
count(location, word, sort = TRUE) %>%
bind_tf_idf(word, location, n)
bencana_tfidf
#install.packages('topicmodels')
# mengubah ke bentuk dtm biar bisa dipake di LDA
bencana_dtm <- bencana_tidy %>%
count(location, word) %>%
cast_dtm(location, word, n)
bencana_dtm
# LDA utk membuat 5 topik dari bencana_dtm
bencana_lda <- LDA(bencana_dtm, k = 5)
bencana_lda
bencana_gamma <- bencana_lda %>%
tidy(matrix = "gamma") %>%
rename(location = document) %>%
arrange(location, desc(gamma))
bencana_gamma
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_col()
bencana_gamma
bencana_beta <- bencana_lda %>%
tidy(matrix = "beta") %>%
rename(word = term) %>%
arrange(topic, desc(beta))
bencana_beta
bencana_beta %>%
group_by(topic) %>%
top_n(10, beta)
bencana_beta <- bencana_lda %>%
tidy(matrix = "beta") %>%
rename(word = term) %>%
arrange(topic, desc(beta))
bencana_beta
bencana_beta %>%
group_by(topic) %>%
top_n(10, beta)
bencana_tidy %>% filter(str_detect(location, "<"))
bencana_tidy %>% filter(str_detect(location, "^<"))
bencana_tidy %>% filter(str_detect(location, "$<"))
bencana_tidy %>% filter(str_detect(location, "Dhabi"))
bencana_tidy %>% filter(str_detect(location, "^A"))
bencana_tidy %>% filter(str_detect(location, "^<"))
bencana_tidy %>% filter(str_detect(location, "\\d"))
# menghapus link yang ada
bencana_tidy <- bencana_tidy %>% filter(word != "t.co", word != "https", !str_detect(location, "\\d"))
bencana_tidy %>% count(location, word, sort = TRUE)
# menghapus link yang ada
bencana_tidy <- bencana_tidy %>% filter(word != "t.co", word != "https", !str_detect(location, "\\d"))
glimpse(bencana_tidy)
bencana_tidy %>% count(location, word, sort = TRUE)
bencana_tidy %>% filter(str_detect(location, "\\d"))
bencana_tidy %>% filter(str_detect(location, "\\d"))
# menghapus link yang ada
bencana_tidy <- bencana_tidy %>% filter(word != "t.co", word != "https")
bencana_tidy %>% filter(str_detect(location, "\\d"))
bencana_tidy <- bencana %>%
filter(!is.na(location), !is.na(text)) %>%
group_by(location) %>%
unnest_tokens(word, text) %>%
ungroup() %>%
anti_join(stop_words)
bencana_tidy <- bencana %>%
filter(!is.na(location), !is.na(text)) %>%
group_by(location) %>%
unnest_tokens(word, text) %>%
ungroup() %>%
anti_join(stop_words)
# menghapus link yang ada
bencana_tidy <- bencana_tidy %>% filter(word != "t.co", word != "https")
glimpse(bencana_tidy)
bencana_tidy %>% count(location, word, sort = TRUE)
bencana_tidy %>% filter(str_detect(location, "\\d"))
bencana_tidy %>% filter(!str_detect(location, "\\d"))
bencana_tidy %>% filter(!str_detect(location, "^'<"))
bencana_tidy %>% filter(str_detect(location, "^'<"))
bencana_tidy %>% filter(str_detect(location, "^'<"))
bencana_tidy %>% filter(str_detect(location, "^'<'"))
bencana_tidy %>% filter(str_detect(location, "^<"))
bencana_tidy %>% filter(str_detect(location, "^\<"))
bencana_tidy %>% filter(str_detect(location, "^/<"))
bencana_tidy %>% filter(str_detect(location, "^A"))
bencana_tidy %>% filter(str_detect(location, "^{A}"))
bencana_tidy %>% filter(str_detect(location, "{^A}"))
bencana_tidy %>% filter(str_detect(location, "\\d"))
bencana_tidy %>% filter(str_detect(location, "^\\d"))
bencana_tidy %>% filter(str_detect(location, "[<]"))
bencana_tidy %>% filter(str_detect(location, "<"))
bencana_tidy %>% filter(str_detect(location, "(A)"))
bencana_tidy %>% filter(str_detect(location, ""))
bencana_tidy %>% filter(str_detect(location, "<U+041"))
bencana_tidy %>% filter(str_detect(location, "U+041"))
bencana_tidy %>% filter(str_detect(location %in% "U+041"))
bencana_tidy %>% filter(str_detect(location, "U+041"))
bencana_tidy %>% filter(str_detect(location, "U+"))
bencana_tidy %>% filter(str_detect(location, "\U+"))
bencana_tidy %>% filter(str_detect(location, "\\U+"))
bencana_tidy %>% filter(str_detect(location, "U+"))
bencana_tidy %>% filter(str_detect(location, c("<")))
041
bencana_tidy %>% filter(str_detect(location, "U+041"))
bencana_tidy %>% filter(str_detect(location, "'<'"))
bencana_tidy %>% filter(str_detect(location, ""<"))
bencana_tidy %>% filter(str_detect(location, ""<""))
bencana_tidy %>% filter(str_detect(location, "`<`"))
bencana_tidy %>% filter(str_detect(location, ".<"))
bencana_tidy %>% filter(str_detect(location, ".<."))
bencana_tidy %>% filter(str_detect(location, "<?"))
bencana_tidy %>% filter(str_detect(location, "<"))
bencana_tidy %>% filter(str_detect(location, "A"))
bencana_tidy %>% filter(str_detect(location, "\\d"))
bencana_tidy %>% filter(str_detect(location, "[:punct:]"))
bencana_tidy %>% filter(str_detect(location, "[:punct <:]"))
bencana_tidy %>% filter(str_detect(location, "[:<:]"))
punct
bencana_tidy %>% filter(str_detect(location, "[:punct:]"))
bencana_tidy %>% filter(str_detect(location, "\\<\\"))
bencana_tidy %>% filter(str_detect(location, grepl("\\<\\")))
bencana_tidy %>% filter(str_detect(location, grepl("\\<\\", ignore.case = TRUE, V2)))
bencana_tidy %>% filter(str_detect(location, grepl("\\<\\", ignore.case = TRUE)))
bencana_tidy %>% filter(str_detect(location, grepl("^\\<\\", ignore.case = TRUE)))
bencana_tidy %>% filter(str_detect(location, "^\\<\\"))
bencana_tidy %>% filter(str_detect(location, "^\<\"))
bencana_tidy %>% filter(str_detect(location, "^<\"))
bencana_tidy %>% filter(str_detect(location, "^<\"))
bencana_tidy %>% filter(str_detect(location, "^\<\"))
bencana_tidy %>% filter(str_detect(location, "^\<\"))
# menghapus link yang ada
bencana_tidy <- bencana_tidy %>% filter(word != "t.co", word != "https", !str_detect(location, "^\\d"))
bencana_tidy %>% count(location, word, sort = TRUE)
bencana_tfidf <- bencana_tidy %>%
count(location, word, sort = TRUE) %>%
bind_tf_idf(word, location, n)
bencana_tfidf
bencana_gamma <- bencana_lda %>%
tidy(matrix = "gamma") %>%
rename(location = document) %>%
arrange(location, desc(gamma))
bencana_gamma
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_col()
#install.packages('topicmodels')
# mengubah ke bentuk dtm biar bisa dipake di LDA
bencana_dtm <- bencana_tidy %>%
count(location, word) %>%
cast_dtm(location, word, n)
bencana_dtm
# LDA utk membuat 5 topik dari bencana_dtm
bencana_lda <- LDA(bencana_dtm, k = 5)
bencana_lda
bencana_tfidf <- bencana_tidy %>%
count(location, word, sort = TRUE) %>%
bind_tf_idf(word, location, n)
bencana_tfidf
bencana_gamma <- bencana_lda %>%
tidy(matrix = "gamma") %>%
rename(location = document) %>%
arrange(location, desc(gamma))
bencana_gamma
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_col()
bencana_tidy
bencana_beta <- bencana_lda %>%
tidy(matrix = "beta") %>%
rename(word = term) %>%
arrange(topic, desc(beta))
bencana_beta
bencana_beta %>%
group_by(topic) %>%
top_n(10, beta)
bencana_beta <- bencana_lda %>%
tidy(matrix = "beta") %>%
rename(word = term) %>%
arrange(topic, desc(beta))
bencana_beta %>%
group_by(topic) %>%
top_n(10, beta)
bencana_beta
knitr::opts_chunk$set(echo = TRUE)
library(shiny)
library(here)
library(vroom)
library(dplyr)
library(ggplot2)
library(plotly)
library(topicmodels)
library(tidyverse)
library(tidytext)
bencana <- vroom(here("data-raw", "tweets.csv"))
glimpse(bencana)
bencana_tidy <- bencana %>%
filter(!is.na(location), !is.na(text)) %>%
group_by(location) %>%
unnest_tokens(word, text) %>%
ungroup() %>%
anti_join(stop_words)
# menghapus link yang ada
bencana_tidy <- bencana_tidy %>% filter(word != "t.co", word != "https", !str_detect(location, "^\\d"))
glimpse(bencana_tidy)
bencana_tidy %>% count(location, word, sort = TRUE)
bencana_tidy <- bencana %>%
filter(!is.na(location), !is.na(text)) %>%
group_by(keyword) %>%
unnest_tokens(word, text) %>%
ungroup() %>%
anti_join(stop_words)
# menghapus link yang ada
bencana_tidy <- bencana_tidy %>% filter(word != "t.co", word != "https", !str_detect(location, "^\\d"))
bencana_tidy <- bencana %>%
filter(!is.na(location), !is.na(text)) %>%
group_by(keyword) %>%
unnest_tokens(word, text) %>%
ungroup() %>%
anti_join(stop_words)
# menghapus link yang ada
bencana_tidy <- bencana_tidy %>% filter(word != "t.co", word != "https")
glimpse(bencana_tidy)
bencana_tidy %>% count(location, word, sort = TRUE)
bencana_tidy <- bencana %>%
filter(!is.na(location), !is.na(text)) %>%
group_by(keyword) %>%
unnest_tokens(word, text) %>%
ungroup() %>%
anti_join(stop_words)
# menghapus link yang ada
bencana_tidy <- bencana_tidy %>% filter(word != "t.co", word != "https")
glimpse(bencana_tidy)
bencana_tidy %>% count(keyword, word, sort = TRUE)
bencana_tidy <- bencana %>%
filter(!is.na(location), !is.na(text)) %>%
group_by(keyword) %>%
unnest_tokens(word, text) %>%
ungroup() %>%
anti_join(stop_words)
# menghapus link yang ada
bencana_tidy <- bencana_tidy %>% filter(word != "t.co", word != "https")
glimpse(bencana_tidy)
bencana_tidy %>% count(keyword, word, sort = TRUE)
bencana_tfidf <- bencana_tidy %>%
count(keyword, word, sort = TRUE) %>%
bind_tf_idf(word, keyword, n)
bencana_tfidf
#install.packages('topicmodels')
# mengubah ke bentuk dtm biar bisa dipake di LDA
bencana_dtm <- bencana_tidy %>%
count(keyword, word) %>%
cast_dtm(keyword, word, n)
bencana_dtm
# LDA utk membuat 5 topik dari bencana_dtm
bencana_lda <- LDA(bencana_dtm, k = 5)
bencana_lda
bencana_gamma <- bencana_lda %>%
tidy(matrix = "gamma") %>%
rename(location = document) %>%
arrange(location, desc(gamma))
bencana_gamma
bencana_tidy
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_col()
bencana_beta <- bencana_lda %>%
tidy(matrix = "beta") %>%
rename(word = term) %>%
arrange(topic, desc(beta))
bencana_beta %>%
group_by(topic) %>%
top_n(10, beta)
bencana_beta
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_col() +
coord_flip()
bencana_gamma
bencana_tidy
bencana_gamma <- bencana_lda %>%
tidy(matrix = "gamma") %>%
rename(location = document) %>%
arrange(location, desc(gamma))
bencana_gamma
bencana_tidy
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_col() +
coord_flip()
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic)), position = position_stack(vjust = .5)) +
geom_col() +
coord_flip()
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic)), position = position_stack(vjust = .10)) +
geom_col() +
coord_flip()
bencana_gamma <- bencana_lda %>%
tidy(matrix = "gamma") %>%
rename(location = document) %>%
arrange(location, desc(gamma))
bencana_gamma
bencana_tidy
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_col() +
coord_flip()
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_col() +
coord_flip() +
scale_x_discrete(guide = guide_axis(n.dodge=3))
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_col() +
scale_x_discrete(guide = guide_axis(n.dodge=3))
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_col() +
coord_flip() +
scale_x_discrete(guide = guide_axis(n.dodge=3))
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_line() +
coord_flip() +
scale_x_discrete(guide = guide_axis(n.dodge=3))
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_point() +
coord_flip() +
scale_x_discrete(guide = guide_axis(n.dodge=3))
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_point() +
coord_flip()
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_point()
bencana_gamma <- bencana_lda %>%
tidy(matrix = "gamma") %>%
rename(location = document) %>%
arrange(location, desc(gamma))
bencana_gamma
bencana_tidy
bencana_gamma %>%
ggplot(aes(x = rev(location), y = gamma, fill = factor(topic))) +
geom_col() +
coord_flip()
bencana_tfidf <- bencana_tidy %>%
count(keyword, word, sort = TRUE) %>%
bind_tf_idf(word, keyword, n)
bencana_tfidf
# tf = banyaknya kata i pada dokumen j
# idf = banyaknya dokumen yang mengandung kata i
bencana_tfidf %>%
filter(keyword == "explosion") %>%
top_n(15, tf_idf) %>%
ggplot(aes(x = reorder(word, tf_idf), y = tf_idf)) +
geom_col() +
coord_flip() +
labs(
x = "",
y = "tf-idf",
title = "Kata terpenting",
subtitle = "================================"
) +
theme_light()
bencana_tfidf
bencana_tfidf %>%
filter(keyword == "explosion") %>%
top_n(15, tf_idf) %>%
ggplot(aes(x = reorder(word, tf_idf), y = tf_idf)) +
geom_col() +
coord_flip() +
labs(
x = "",
y = "tf-idf",
title = "Kata terpenting",
subtitle = "================================"
) +
theme_light()
bencana_tfidf
